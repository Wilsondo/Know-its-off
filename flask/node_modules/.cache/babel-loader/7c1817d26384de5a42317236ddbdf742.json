{"ast":null,"code":"import _classCallCheck from\"/mnt/e/MyReact/new_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/mnt/e/MyReact/new_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/mnt/e/MyReact/new_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/mnt/e/MyReact/new_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import axiosBaseURL from'../axios.js';import{Redirect}from'react-router-dom';import{CircleSpinner}from'react-spinners-kit';import GridApp from'./grid/GridApp';import GridContext from'./grid/GridContext';import{getToken,onMessageListener}from'./firebase';import{Button,Toast}from'react-bootstrap';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Home=/*#__PURE__*/function(_Component){_inherits(Home,_Component);var _super=_createSuper(Home);function Home(props){var _this;_classCallCheck(this,Home);_this=_super.call(this,props);_this.count_dev_state=function(arr){var result=0;for(var x=0;arr.length>x;x++){if(arr[x].device_state===1){result++;}}return result;};_this.state={myDevices:[],loading:true,error:false,redirect:null,isTokenFound:false,setTokenFound:false,show:false,setShow:false,notification:{title:'',body:''},setNotification:{title:'',body:''}};return _this;}_createClass(Home,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;axiosBaseURL.get(\"/devices\").then(function(app_result){_this2.setState({myDevices:app_result.data,num_on:_this2.count_dev_state(app_result.data)});var context=_this2.context;context.setItems(app_result.data);_this2.setState({loading:false});}).catch(function(error){_this2.setState({loading:false,error:true});console.log(\"error at get device: \",error.response);});}},{key:\"render\",value:function render(){var _this3=this;if(this.state.loading){return/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center m-5\",children:/*#__PURE__*/_jsx(CircleSpinner,{size:60,color:\"#686769\",loading:this.state.loading})});}if(this.state.error){if(this.state.redirect){return/*#__PURE__*/_jsx(Redirect,{to:this.state.redirect});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{children:\"There was an error\"}),/*#__PURE__*/_jsx(\"h3\",{children:this.state.error_response})]});}var _this$state=this.state,isTokenFound=_this$state.isTokenFound,setTokenFound=_this$state.setTokenFound,show=_this$state.show,setShow=_this$state.setShow,notification=_this$state.notification;getToken(setTokenFound);onMessageListener().then(function(payload){//setNotification({title: payload.notification.title, body: payload.notification.body});\n_this3.setState({setNotification:{title:payload.notification.title,body:payload.notification.body,setShow:true}});console.log(payload);}).catch(function(err){return console.log('failed: ',err);});return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Toast,{onClose:function onClose(){return setShow(false);},show:show,delay:3000,autohide:true,animation:true,style:{position:'absolute',top:20,right:20,minWidth:200},children:/*#__PURE__*/_jsx(Toast.Header,{children:/*#__PURE__*/_jsx(\"img\",{src:\"holder.js/20x20?text=%20\",className:\"rounded mr-2\",alt:\"\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"row m-3 text-light\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:/*#__PURE__*/_jsx(\"h1\",{className:\"text-center\",children:\"Home\"})})}),/*#__PURE__*/_jsx(\"div\",{className:\"row m-3 text-light\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:/*#__PURE__*/_jsxs(\"h6\",{className:\"text-muted text-center\",children:[this.state.num_on,\" of your appliances are on.\",isTokenFound&&/*#__PURE__*/_jsx(\"h1\",{children:\" Notification permission enabled \\uD83D\\uDC4D\\uD83C\\uDFFB \"}),!isTokenFound&&/*#__PURE__*/_jsx(\"h1\",{children:\" Need notification permission \\u2757\\uFE0F \"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return _this3.setState({setShow:true});},children:\"Show Toast\"})]})})}),/*#__PURE__*/_jsx(GridApp,{})]});}}]);return Home;}(Component);Home.contextType=GridContext;export{Home as default};","map":{"version":3,"sources":["/mnt/e/MyReact/new_frontend/src/components/home.js"],"names":["React","Component","axiosBaseURL","Redirect","CircleSpinner","GridApp","GridContext","getToken","onMessageListener","Button","Toast","Home","props","count_dev_state","arr","result","x","length","device_state","state","myDevices","loading","error","redirect","isTokenFound","setTokenFound","show","setShow","notification","title","body","setNotification","get","then","app_result","setState","data","num_on","context","setItems","catch","console","log","response","error_response","payload","err","position","top","right","minWidth","contextType"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport axiosBaseURL from '../axios.js';\nimport {Redirect} from 'react-router-dom';\nimport {CircleSpinner} from 'react-spinners-kit';\nimport GridApp from './grid/GridApp';\nimport GridContext from './grid/GridContext';\nimport { getToken, onMessageListener } from './firebase';\nimport {Button, Toast} from 'react-bootstrap';\n\n\n\nexport default class Home extends Component {\n   static contextType = GridContext\n   constructor(props) {\n      super(props);\n      this.state = {\n         myDevices: [],\n         loading: true,\n         error: false,\n         redirect: null,\n         isTokenFound: false, \n         setTokenFound: false, \n         show: false, \n         setShow: false, \n         notification: {title: '', body: ''}, \n         setNotification: {title: '', body: ''}\n      };\n   };\n\n\ncount_dev_state = (arr) => {\n   var result = 0;\n   for(var x = 0; arr.length > x; x++){\n      if(arr[x].device_state === 1){\n         result++;\n      }\n   }\n   return result;\n}\n\ncomponentDidMount() {\n   axiosBaseURL.get(\"/devices\")\n      .then( (app_result) => {\n         this.setState({\n            myDevices: app_result.data,\n            num_on: this.count_dev_state(app_result.data)\n         })\n         const context = this.context\n         context.setItems(app_result.data)\n         this.setState({loading: false})\n      })\n      .catch( (error) => {\n         this.setState({loading: false, error: true});\n         console.log(\"error at get device: \", error.response)\n      })\n}\n\nrender(){\n   if(this.state.loading) {\n       return (\n         <div className=\"d-flex justify-content-center m-5\">\n            <CircleSpinner size={60} color=\"#686769\" loading={this.state.loading} />\n         </div>)\n   }\n   if(this.state.error) {\n      if(this.state.redirect) {return <Redirect to={this.state.redirect} />}\n      return(<div><h3>There was an error</h3><h3>{this.state.error_response}</h3></div>)\n   }\n   const {isTokenFound, setTokenFound, show, setShow, notification} = this.state;\n\n   getToken(setTokenFound);\n   onMessageListener().then(payload => {\n      //setNotification({title: payload.notification.title, body: payload.notification.body});\n      this.setState({setNotification: {title: payload.notification.title, body: payload.notification.body, setShow: true}})\n      console.log(payload);\n    }).catch(err => console.log('failed: ', err));\n   return(\n      <div>\n         <Toast onClose={() => setShow(false)} show={show} delay={3000} autohide animation style={{\n            position: 'absolute',\n            top: 20,\n            right: 20,\n            minWidth: 200\n         }}>\n            <Toast.Header>\n               <img\n               src=\"holder.js/20x20?text=%20\"\n               className=\"rounded mr-2\"\n               alt=\"\"\n               />\n            </Toast.Header>\n         </Toast>\n      <div className=\"row m-3 text-light\">\n         <div className=\"col\">\n            <h1 className=\"text-center\">Home</h1>\n         </div>\n      </div>\n      <div className=\"row m-3 text-light\">\n         <div className=\"col\">\n            <h6 className=\"text-muted text-center\">\n               {this.state.num_on} of your appliances are on.\n               {isTokenFound && <h1> Notification permission enabled 👍🏻 </h1>}\n               {!isTokenFound && <h1> Need notification permission ❗️ </h1>} \n               <Button onClick={() => this.setState({setShow: true})}>Show Toast</Button>\n            </h6>\n         </div>\n      </div>\n      <GridApp/>      \n   </div>\n   )\n}}\n"]},"metadata":{},"sourceType":"module"}