{"ast":null,"code":"import _classCallCheck from\"/mnt/e/MyReact/new_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/mnt/e/MyReact/new_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/mnt/e/MyReact/new_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/mnt/e/MyReact/new_frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import firebase from'firebase/app';import'firebase/messaging';import React,{Component}from'react';import axiosBaseURL from'../axios.js';import{Toast}from'react-bootstrap';import{jsx as _jsx}from\"react/jsx-runtime\";var firebaseConfig={apiKey:\"AIzaSyCGG2bVOzc9jR_dPhNlTxEn_ZTajkcHVzo\",authDomain:\"know-its-off-jsyg.firebaseapp.com\",projectId:\"know-its-off-jsyg\",storageBucket:\"know-its-off-jsyg.appspot.com\",messagingSenderId:\"1039398438265\",appId:\"1:1039398438265:web:f0e1ae04a1db6c68025ba8\"};firebase.initializeApp(firebaseConfig);var messaging=firebase.messaging();export var getToken=function getToken(setTokenFound){return messaging.getToken({vapidKey:'BHqTAUfRBDJlK88PZlXUl92tdXi_YmKp7HaR0RMHQBp0cXZ9bKxW3m53TN9KAf6WhuuO6ZkhYObb9fNOae85ZAc'}).then(function(currentToken){if(currentToken){console.log('current token for client: ',currentToken);setTokenFound=true;// Track the token -> client mapping, by sending to backend server\n// show on the UI that permission is secured\n}else{console.log('No registration token available. Request permission to generate one.');setTokenFound=false;// shows on the UI that permission is required \n}}).catch(function(err){console.log('An error occurred while retrieving token. ',err);// catch error while creating client token\n});};export var onMessageListener=function onMessageListener(){return new Promise(function(resolve){messaging.onMessage(function(payload){resolve(payload);});});};var Firebase=/*#__PURE__*/function(_Component){_inherits(Firebase,_Component);var _super=_createSuper(Firebase);function Firebase(props){var _this;_classCallCheck(this,Firebase);_this=_super.call(this,props);_this.state={myDevice:[],setTokenFound:false,show:true,notification:{title:'',body:''}};return _this;}_createClass(Firebase,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;axiosBaseURL.get(\"/devices\").then(function(app_result){_this2.setState({myDevices:app_result.data});}).catch(function(error){_this2.setState({loading:false,error:true});console.log(\"error at get device: \",error.response);});}},{key:\"render\",value:function render(){var _this3=this;getToken(this.state.setTokenFound);onMessageListener().then(function(payload){_this3.setState({notification:{title:payload.notification.title,body:payload.notification.body,show:true}});console.log(payload);}).catch(function(err){return console.log('failed: ',err);});return/*#__PURE__*/_jsx(Toast,{onClose:function onClose(){return _this3.setState({show:false});},show:this.state.show,delay:3000,autohide:true,animation:true,style:{position:'absolute',top:20,right:20,minWidth:200}});}}]);return Firebase;}(Component);export{Firebase as default};","map":{"version":3,"sources":["/mnt/e/MyReact/new_frontend/src/components/firebase.js"],"names":["firebase","React","Component","axiosBaseURL","Toast","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","initializeApp","messaging","getToken","setTokenFound","vapidKey","then","currentToken","console","log","catch","err","onMessageListener","Promise","resolve","onMessage","payload","Firebase","props","state","myDevice","show","notification","title","body","get","app_result","setState","myDevices","data","error","loading","response","position","top","right","minWidth"],"mappings":"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","sourcesContent":["import firebase from 'firebase/app';\r\nimport 'firebase/messaging';\r\nimport React, {Component} from 'react';\r\nimport axiosBaseURL from '../axios.js';\r\nimport { Toast } from 'react-bootstrap';\r\n\r\n\r\nvar firebaseConfig = {\r\n  apiKey: \"AIzaSyCGG2bVOzc9jR_dPhNlTxEn_ZTajkcHVzo\",\r\n  authDomain: \"know-its-off-jsyg.firebaseapp.com\",\r\n  projectId: \"know-its-off-jsyg\",\r\n  storageBucket: \"know-its-off-jsyg.appspot.com\",\r\n  messagingSenderId: \"1039398438265\",\r\n  appId: \"1:1039398438265:web:f0e1ae04a1db6c68025ba8\"\r\n};\r\n\r\nfirebase.initializeApp(firebaseConfig);\r\n\r\nconst messaging = firebase.messaging();\r\n\r\nexport const getToken = (setTokenFound) => {\r\n  return messaging.getToken({vapidKey: 'BHqTAUfRBDJlK88PZlXUl92tdXi_YmKp7HaR0RMHQBp0cXZ9bKxW3m53TN9KAf6WhuuO6ZkhYObb9fNOae85ZAc'}).then((currentToken) => {\r\n    if (currentToken) {\r\n      console.log('current token for client: ', currentToken);\r\n      setTokenFound = true;\r\n      // Track the token -> client mapping, by sending to backend server\r\n      // show on the UI that permission is secured\r\n    } else {\r\n      console.log('No registration token available. Request permission to generate one.');\r\n      setTokenFound = false;\r\n      // shows on the UI that permission is required \r\n    }\r\n  }).catch((err) => {\r\n    console.log('An error occurred while retrieving token. ', err);\r\n    // catch error while creating client token\r\n  });\r\n}\r\n\r\nexport const onMessageListener = () =>\r\nnew Promise((resolve) => {\r\n  messaging.onMessage((payload) => {\r\n    resolve(payload);\r\n  });\r\n});\r\n\r\nexport default class Firebase extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n    this.state = {\r\n      myDevice: [],\r\n      setTokenFound: false, \r\n      show: true, \r\n      notification: {title: '', body: ''}\r\n    }\r\n  };\r\n\r\n\r\n  componentDidMount() {\r\n    axiosBaseURL.get(\"/devices\").then( (app_result) => {\r\n        this.setState({\r\n          myDevices: app_result.data,\r\n        })\r\n    })\r\n    .catch( (error) => {\r\n      this.setState({loading: false, error: true});\r\n      console.log(\"error at get device: \", error.response)\r\n    })\r\n  }\r\n\r\n  render() {\r\n    getToken(this.state.setTokenFound);\r\n    onMessageListener().then(payload => {\r\n       this.setState({notification: {title: payload.notification.title, body: payload.notification.body, show: true}})\r\n       console.log(payload);\r\n     }).catch(err => console.log('failed: ', err));\r\n    return(\r\n      <Toast onClose={() => this.setState({show: false})} show={this.state.show} delay={3000} autohide animation style={{\r\n        position: 'absolute',\r\n        top: 20,\r\n        right: 20,\r\n        minWidth: 200}}></Toast>\r\n    )\r\n  }\r\n}\r\n\r\n"]},"metadata":{},"sourceType":"module"}