{"ast":null,"code":"import _defineProperty from\"/home/ec2-user/capstone/flask/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/ec2-user/capstone/flask/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/ec2-user/capstone/flask/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/ec2-user/capstone/flask/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/ec2-user/capstone/flask/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/ec2-user/capstone/flask/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{CircleSpinner}from'react-spinners-kit';import axiosBaseURL from'../axios.js';import Tile from\"./tile.js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var addDevice=/*#__PURE__*/function(_Component){_inherits(addDevice,_Component);var _super=_createSuper(addDevice);function addDevice(props){var _this;_classCallCheck(this,addDevice);_this=_super.call(this,props);_this.postData=function(event){_this.setState({postLoading:true});//if creating a new appliance post it first\naxiosBaseURL.get(\"/allDevices\").then(function(result){_this.setState({allDevices:result.data});});var idVerify=true;for(var x=0;x<_this.state.allDevices.length;x++){if(_this.state.myDevice.id===_this.state.allDevices[x].id){idVerify=false;}}if(idVerify||_this.state.myDevice.id===\"0\"){console.log(_this.state.myDevice);axiosBaseURL.post('/device',_this.state.myDevice).then(function(result){_this.setState({myDevice:_objectSpread(_objectSpread({},_this.state.myDevice),{},{id:result.data.id}),postLoading:false,revealDetails:true});alert(\"Device Creation Successful!\");_this.props.history.push('/home');}).catch(function(error){_this.setState({loading:false});alert(\"Please enter a valid Device ID!\");});}event.preventDefault();};_this.handleChangeDevice=function(event){_this.setState({myDevice:_objectSpread(_objectSpread({},_this.state.myDevice),{},_defineProperty({},event.target.name,event.target.value))});};_this.state={myDevice:{id:\"0\",appliance_name:\"My Appliance\",device_state:0,device_battery:100.0},userDevices:[],applianceNames:[],allDevices:[],disabled:false,loading:true,error:false,postLoading:false,redirect:null,revealDetails:false};return _this;}//Get users appliances, add the names to the select form element\n_createClass(addDevice,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;axiosBaseURL.get(\"/devices\").then(function(result){_this2.setState({loading:false,usersDevices:result.data});var myList=[];var i;for(i in _this2.state.usersDevices){myList.push([_this2.state.usersDevices[i].appliance_name,_this2.state.usersDevices[i].id,_this2.state.usersDevices[i].device_battery,_this2.state.usersDevices[i].device_state]);}_this2.setState({applianceNames:myList});}).catch(function(error){_this2.setState({loading:false,error:true});if(error.response){_this2.setState({error_response:error.response.data});if(error.response.data===\"not authorized\"){_this2.setState({redirect:\"/\"});}else if(error.response.data){console.log(error.response.data);}}});}},{key:\"render\",value:function render(){if(this.state.error){return/*#__PURE__*/_jsx(\"div\",{className:\"m-5\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"There was an error\"})});}if(this.state.loading){return/*#__PURE__*/_jsx(\"div\",{className:\"d-flex justify-content-center m-5\",children:/*#__PURE__*/_jsx(CircleSpinner,{size:60,color:\"#686769\",loading:this.state.loading})});}var revealDetails=this.state.revealDetails;return/*#__PURE__*/_jsxs(\"div\",{className:\"m-5 text-light\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"New Device\"}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Appliance Name\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control text-dark\",name:\"appliance_name\",id:\"inputApplianceName\",\"aria-describedby\":\"nameHelp\",onChange:this.handleChangeDevice,value:this.state.myDevice.appliance_name}),/*#__PURE__*/_jsx(\"label\",{children:\"Device ID\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control text-dark\",name:\"id\",id:\"inputId\",\"aria-describedby\":\"nameHelp\",onChange:this.handleChangeDevice,value:this.state.myDevice.id})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:this.postData,className:\"btn btn-success\",children:[\"Add this device\",/*#__PURE__*/_jsx(CircleSpinner,{size:20,color:\"#3BBCE5\",loading:this.state.postLoading})]})]}),revealDetails&&/*#__PURE__*/_jsx(Tile,{device_id:this.state.myDevice.id,device_battery:this.state.myDevice.device_battery,appliance_name:this.state.myDevice.appliance_name,state:this.state.myDevice.device_state,timestamp:this.state.myDevice.timestamp},this.state.myDevice.id)]});}}]);return addDevice;}(Component);export{addDevice as default};","map":{"version":3,"sources":["/home/ec2-user/capstone/flask/src/components/addDevice.js"],"names":["React","Component","CircleSpinner","axiosBaseURL","Tile","addDevice","props","postData","event","setState","postLoading","get","then","result","allDevices","data","idVerify","x","state","length","myDevice","id","console","log","post","revealDetails","alert","history","push","catch","error","loading","preventDefault","handleChangeDevice","target","name","value","appliance_name","device_state","device_battery","userDevices","applianceNames","disabled","redirect","usersDevices","myList","i","response","error_response","timestamp"],"mappings":"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","sourcesContent":["import React, {Component} from 'react'\nimport {CircleSpinner} from 'react-spinners-kit' \nimport axiosBaseURL from '../axios.js'\nimport Tile from \"./tile.js\";\n\nexport default class addDevice extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      myDevice: {\n         id: \"0\",\n\t\t   appliance_name: \"My Appliance\",\n         device_state: 0, \n         device_battery: 100.0,\n\t   },\n      userDevices: [],\n      applianceNames: [],\n      allDevices: [],\n      disabled: false,\n\t   loading: true,\n\t   error: false,\n\t   postLoading: false,\n      redirect: null, \n      revealDetails: false, \n    };\n  }\n\n   //Get users appliances, add the names to the select form element\n   componentDidMount() {\n      axiosBaseURL.get(\"/devices\")\n      .then((result) => {\n         this.setState({\n            loading: false,\n            usersDevices: result.data\n         });\n         var myList = [];\n         var i;\n         for(i in this.state.usersDevices) {\n            myList.push([this.state.usersDevices[i].appliance_name, this.state.usersDevices[i].id, this.state.usersDevices[i].device_battery, this.state.usersDevices[i].device_state])\n         }\n         this.setState({applianceNames: myList})\n      })\n      .catch( (error) => {\n         this.setState({loading: false, error: true});\n         if(error.response){\n            this.setState({error_response: error.response.data});\n            if(error.response.data === \"not authorized\"){ this.setState({redirect: \"/\"}) }\n            else if (error.response.data){console.log(error.response.data)}\n         }\n      })\n   }\n\n   postData = (event) => {\n      this.setState({postLoading:true});\n      //if creating a new appliance post it first\n\n      axiosBaseURL.get(\"/allDevices\")\n      .then((result) => {\n         this.setState({\n            allDevices: result.data\n         })\n      })\n      let idVerify = true;\n      for(var x = 0;x < this.state.allDevices.length; x++)\n         if(this.state.myDevice.id === this.state.allDevices[x].id){\n            idVerify = false;\n         }\n      if(idVerify || this.state.myDevice.id === \"0\"){\n         console.log(this.state.myDevice);\n         axiosBaseURL.post('/device', this.state.myDevice)\n         .then((result) => {\n            this.setState({ myDevice: {...this.state.myDevice, id: result.data.id}, postLoading:false, revealDetails:true })\n            alert(\"Device Creation Successful!\");\n            this.props.history.push('/home');\n         })\n         .catch((error) => {\n            this.setState({loading: false})\n            alert(\"Please enter a valid Device ID!\");\n         })\n      }\n      event.preventDefault();\n   };\n\n   handleChangeDevice = (event) => {\n      this.setState({\n         myDevice : {...this.state.myDevice, [event.target.name]: event.target.value}\n      });\n   };\n\n\trender(){\n\t\tif(this.state.error){ \n         return(<div className=\"m-5\"><h3>There was an error</h3></div>) \n      }\n\t\tif(this.state.loading){\n         return (\n            <div className=\"d-flex justify-content-center m-5\">\n               <CircleSpinner size={60} color=\"#686769\" loading={this.state.loading} />\n            </div>)\n      }\n      const {revealDetails} = this.state;\n\t\treturn(\n<div className=\"m-5 text-light\">\n<h3>New Device</h3>\n<form>\n   <div className=\"form-group\">\n      <label>Appliance Name</label>\n      <input className=\"form-control text-dark\" name=\"appliance_name\" id=\"inputApplianceName\" aria-describedby=\"nameHelp\" onChange={this.handleChangeDevice} value={this.state.myDevice.appliance_name} />\n      <label>Device ID</label>\n      <input className=\"form-control text-dark\" name=\"id\" id=\"inputId\" aria-describedby=\"nameHelp\" onChange={this.handleChangeDevice} value={this.state.myDevice.id} />\n   </div>\n\n   <button onClick={this.postData} className=\"btn btn-success\">Add this device<CircleSpinner size={20} color=\"#3BBCE5\" loading={this.state.postLoading} /></button>\n</form>\n{revealDetails && (\n   <Tile key={this.state.myDevice.id} device_id={this.state.myDevice.id} device_battery={this.state.myDevice.device_battery} appliance_name={this.state.myDevice.appliance_name} state={this.state.myDevice.device_state} timestamp={this.state.myDevice.timestamp}></Tile>\n)}\n</div>\n\t\t)\n\t}\n}\n\n"]},"metadata":{},"sourceType":"module"}