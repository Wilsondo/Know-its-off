{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/mnt/e/MyReact/new_frontend/src/components/home.js\";\nimport React, { Component } from 'react';\nimport axiosBaseURL from '../axios.js';\nimport Tile from './tile';\nimport { Redirect } from 'react-router-dom';\nimport { CircleSpinner } from 'react-spinners-kit';\nimport GridApp from './grid/GridApp';\nimport GridContext from './grid/GridContext';\nimport { GridItem, GridDropZone, GridContextProvider } from './grid/Grid';\nexport default class Home extends Component {\n  constructor(props) {\n    super(props);\n\n    this.count_dev_state = arr => {\n      var result = 0;\n\n      for (var x = 0; arr.length > x; x++) {\n        if (arr[x].device_state === true) {\n          result++;\n        }\n      }\n\n      return result;\n    };\n\n    this.state = {\n      myDevices: [],\n      loading: true,\n      error: false,\n      redirect: null\n    };\n  }\n\n  componentDidMount() {\n    axiosBaseURL.get(\"/devices\").then(app_result => {\n      console.log(app_result);\n      this.setState({\n        myDevices: app_result.data,\n        num_on: this.count_dev_state(app_result.data)\n      });\n      const context = this.context;\n      context.setItems(app_result.data);\n      this.setState({\n        loading: false\n      });\n    }).catch(error => {\n      //most likely cause of error here is failed authentication, so redirect\n      this.setState({\n        loading: false,\n        error: true\n      }); //if(error.response.data === \"not authorized\"){this.setState({redirect:\"/login\"})}\n\n      console.log(\"error at get device: \", error.response);\n    });\n  }\n\n  render() {\n    if (this.state.loading) {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"d-flex justify-content-center m-5\",\n        children: /*#__PURE__*/_jsxDEV(CircleSpinner, {\n          size: 60,\n          color: \"#686769\",\n          loading: this.state.loading\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 55,\n        columnNumber: 10\n      }, this);\n    }\n\n    if (this.state.error) {\n      console.log(this.state);\n\n      if (this.state.redirect) {\n        return /*#__PURE__*/_jsxDEV(Redirect, {\n          to: this.state.redirect\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 61,\n          columnNumber: 39\n        }, this);\n      }\n\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n          children: \"There was an error\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 19\n        }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n          children: this.state.error_response\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 46\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 14\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row m-3\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col\",\n          children: /*#__PURE__*/_jsxDEV(\"h1\", {\n            className: \"text-center\",\n            children: \"Home\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 68,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 10\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row m-3\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col\",\n          children: /*#__PURE__*/_jsxDEV(\"h6\", {\n            className: \"text-muted text-center\",\n            children: [this.state.num_on, \" of your appliances are on.\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 10\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 7\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-1 m-3\",\n        children: /*#__PURE__*/_jsxDEV(Tile, {\n          appliance_name: device.appliance_name,\n          device_battery: device.battery_power,\n          device_state: device.device_state\n        }, device.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 7\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 8\n      }, this), /*#__PURE__*/_jsxDEV(GridContextProvider, {\n        onChange: this.onChange,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"container\",\n          children: /*#__PURE__*/_jsxDEV(GridDropZone, {\n            id: \"myDevices\",\n            boxesPerRow: 4,\n            rowHeight: 100,\n            children: this.state.myDevices.map(device => /*#__PURE__*/_jsxDEV(GridItem, {\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"grid-item\",\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"grid-item-content\",\n                  style: {\n                    width: \"100%\",\n                    height: \"100%\"\n                  },\n                  children: /*#__PURE__*/_jsxDEV(Tile, {\n                    appliance_name: device.appliance_name,\n                    device_battery: device.battery_power,\n                    device_state: device.device_state\n                  }, device.id, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 88,\n                    columnNumber: 28\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 87,\n                  columnNumber: 25\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 86,\n                columnNumber: 22\n              }, this)\n            }, device.id, false, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 19\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 10\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 8\n      }, this), /*#__PURE__*/_jsxDEV(GridApp, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 65,\n      columnNumber: 4\n    }, this);\n  }\n\n}\nHome.contextType = GridContext;","map":{"version":3,"sources":["/mnt/e/MyReact/new_frontend/src/components/home.js"],"names":["React","Component","axiosBaseURL","Tile","Redirect","CircleSpinner","GridApp","GridContext","GridItem","GridDropZone","GridContextProvider","Home","constructor","props","count_dev_state","arr","result","x","length","device_state","state","myDevices","loading","error","redirect","componentDidMount","get","then","app_result","console","log","setState","data","num_on","context","setItems","catch","response","render","error_response","device","appliance_name","battery_power","id","onChange","map","width","height","contextType"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport axiosBaseURL from '../axios.js';\nimport Tile from './tile';\nimport {Redirect} from 'react-router-dom';\nimport {CircleSpinner} from 'react-spinners-kit';\nimport GridApp from './grid/GridApp';\nimport GridContext from './grid/GridContext';\nimport { GridItem, GridDropZone, GridContextProvider } from './grid/Grid';\n\nexport default class Home extends Component {\n   static contextType = GridContext\n   constructor(props) {\n      super(props);\n      this.state = {\n         myDevices: [],\n         loading: true,\n         error: false,\n         redirect: null\n      };\n   };\n\ncount_dev_state = (arr) => {\n   var result = 0;\n   for(var x = 0; arr.length > x; x++){\n      if(arr[x].device_state === true){\n         result++;\n      }\n   }\n   return result;\n}\n\ncomponentDidMount() {\n   axiosBaseURL.get(\"/devices\")\n      .then( (app_result) => {\n         console.log(app_result);\n         this.setState({\n            myDevices: app_result.data,\n            num_on: this.count_dev_state(app_result.data)\n         })\n         const context = this.context\n         context.setItems(app_result.data)\n         this.setState({loading: false})\n      })\n      .catch( (error) => {\n         //most likely cause of error here is failed authentication, so redirect\n         this.setState({loading: false, error: true});\n         //if(error.response.data === \"not authorized\"){this.setState({redirect:\"/login\"})}\n         console.log(\"error at get device: \", error.response)\n      })\n}\n\nrender(){\n   if(this.state.loading) {\n       return (\n         <div className=\"d-flex justify-content-center m-5\">\n            <CircleSpinner size={60} color=\"#686769\" loading={this.state.loading} />\n         </div>)\n   }\n   if(this.state.error) {\n      console.log(this.state)\n      if(this.state.redirect) {return <Redirect to={this.state.redirect} />}\n      return(<div><h3>There was an error</h3><h3>{this.state.error_response}</h3></div>)\n   }\n   return(\n   <div>\n      <div className=\"row m-3\">\n         <div className=\"col\">\n            <h1 className=\"text-center\">Home</h1>\n         </div>\n      </div>\n      <div className=\"row m-3\">\n         <div className=\"col\">\n            <h6 className=\"text-muted text-center\">\n               {this.state.num_on} of your appliances are on.\n            </h6>\n         </div>\n      </div>\n      {<div className=\"row row-cols-lg-4 row-cols-md-3 row-cols-sm-2 row-cols-1 m-3\">\n      <Tile key={device.id} appliance_name={device.appliance_name} device_battery={device.battery_power} device_state={device.device_state}/>\n      </div>}\n{      <GridContextProvider onChange={this.onChange}>\n         <div className=\"container\">\n            <GridDropZone id=\"myDevices\" boxesPerRow={4} rowHeight={100}>\n               {this.state.myDevices.map(device => (\n                  <GridItem key={device.id}>\n                     <div className=\"grid-item\">\n                        <div className=\"grid-item-content\" style={{width:\"100%\",height:\"100%\"}}>\n                           <Tile key={device.id} appliance_name={device.appliance_name} device_battery={device.battery_power} device_state={device.device_state}/>\n                        </div>\n                     </div>\n                  </GridItem>\n               ))}\n            </GridDropZone>\n         </div>\n      </GridContextProvider>}\n      <GridApp/>      \n   </div>\n   )\n}}\n"]},"metadata":{},"sourceType":"module"}