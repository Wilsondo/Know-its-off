events {}

http {

    upstream flask {
        server ${FLASK_HOST}:${FLASK_PORT};
    }
    server {
	listen 80;
        server_name _;
        return 301 https://$host$request_uri;
    }
    # a simple reverse-proxy
    server {

        listen 443 default ssl;

	ssl_certificate		/etc/nginx/ssl.crt/certificate.crt;
	ssl_certificate_key	/etc/nginx/ssl.crt/private.key;
	ssl_protocols 		TLSv1.2;

        location / {
            # pass requests to the Flask host
            proxy_pass http://flask;
        }
    }
}
